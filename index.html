<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- FullCalendar -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css">
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>

  <!-- Google Calendar plugin -->
  <script src="https://cdn.jsdelivr.net/npm/@fullcalendar/google-calendar@6.1.11/index.global.min.js"></script>

  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    #calendar {
      height: 100vh;
      padding: 12px;
      box-sizing: border-box;
    }
  </style>
</head>

<body>
  <div id="calendar"></div>

  <script>
    // =========================
    // Google API Key
    // =========================
    const GOOGLE_API_KEY = "AIzaSyDZdH26P0tSEBRNnEa4rE9As7rcd924QJ4";

    // =========================
    // カレンダーごとの表示設定（ここだけ触ればOK）
    // =========================
    const CALENDAR_CONFIG = {
      // メイン
      "bonbonbon0105@gmail.com": {
        visible: true,
        showTitle: true,
        showTime: true,
        color: "#2563eb",
      },

      // 日々タスク
      "q5iptcp4jeta8irgvoqtf8n5ng@group.calendar.google.com": {
        visible: true,
        showTitle: false,
        showTime: false,
        label: "予定あり",
        color: "#2563eb",
      },

      // 掲示板
      "u0dm4646p2nrc4ms7k58jmut4s@group.calendar.google.com": {
        visible: true,
        showTitle: false,
        showTime: false,
        label: "予定あり",
      },
      
    };

    // =========================
    // 表示する eventSources を自動生成
    // =========================
    const EVENT_SOURCES = Object.entries(CALENDAR_CONFIG)
      .filter(([_, cfg]) => cfg.visible)
      .map(([calendarId]) => ({
        googleCalendarId: calendarId,
      }));

    // =========================
    // FullCalendar 初期化
    // =========================
    document.addEventListener("DOMContentLoaded", () => {
      const calendar = new FullCalendar.Calendar(
        document.getElementById("calendar"),
        {
          initialView: "timeGridWeek",
          headerToolbar: {
            left: "prev,next today",
            center: "title",
            right: "timeGridWeek,dayGridMonth",
          },
          nowIndicator: true,
          height: "100%",
          expandRows: true,
          slotMinTime: "06:00:00",
          slotMaxTime: "24:00:00",

          // Google Calendar 設定
          googleCalendarApiKey: GOOGLE_API_KEY,
          eventSources: EVENT_SOURCES,

          // =========================
          // 描画時にカレンダー設定を反映
          // =========================
          eventDidMount: (info) => {
            const calId = info.event.source?.googleCalendarId;
            const cfg = CALENDAR_CONFIG[calId];
            if (!cfg) return;

            // タイトル制御
            if (cfg.showTitle === false) {
              const titleEl = info.el.querySelector(".fc-event-title");
              if (titleEl) {
                titleEl.textContent = cfg.label ?? "";
              }
            }

            // 時間表示制御
            if (cfg.showTime === false) {
              const timeEl = info.el.querySelector(".fc-event-time");
              if (timeEl) {
                timeEl.textContent = "";
              }
            }
          },
        }
      );

      calendar.render();
    });
  </script>
</body>
</html>
